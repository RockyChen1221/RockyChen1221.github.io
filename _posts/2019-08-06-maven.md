---
layout: inner
position: right
title: 'Maven简介/使用'
date: 2019-08-06 09:15:00
categories: development
tags: Maven
featured_image: '/img/posts/01_bloc-jams-angular-1130x864-2x.png'
project_link: ''
button_icon: 'github'
button_text: 'View'
lead_text: 'Maven是一个项目管理和综合工具。Maven提供了开发人员构建一个完整的生命周期框架。开发团队可以自动完成项目的基础工具建设，Maven使用标准的目录结构和默认构建生命周期'
---

/*
Sort: 1
*/

参考：
> [http://blog.csdn.net/longyulu/article/details/8128954](http://blog.csdn.net/longyulu/article/details/8128954) 

### Maven是什么？
Maven是一个项目管理和综合工具。Maven提供了开发人员构建一个完整的生命周期框架。开发团队可以自动完成项目的基础工具建设，Maven使用标准的目录结构和默认构建生命周期。

在多个开发团队环境时，Maven可以设置按标准在非常短的时间里完成配置工作。由于大部分项目的设置都很简单，并且可重复使用，Maven让开发人员的工作更轻松，同时创建报表，检查，构建和测试自动化设置。

Maven提供了开发人员的方式来管理：

1. 版本 </br>
    maven有自己的版本定义和规则
2. 构建 </br>
    maven支持许多种的应用程序类型，对于每一种支持的应用程序类型都定义好了一组构建规则和工具集。
3. 输出物管理 </br>
    maven可以管理项目构建的产物，并将其加入到用户库中。这个功能可以用于项目组和其他部门之间的交付行为。
4. 依赖关系 </br>
    maven对依赖关系的特性进行细致的分析和划分，避免开发过程中的依赖混乱和相互污染行为
5. 文档和构建结果 </br>
    maven的site命令支持各种文档信息的发布，包括构建过程的各种输出，javadoc，产品文档等。
6. 项目关系 </br>
    一个大型的项目通常有几个小项目或者模块组成，用maven可以很方便地管理
7. 移植性管理 </br>
    maven可以针对不同的开发场景，输出不同种类的输出结果。

概括地说，Maven简化和标准化项目建设过程。处理编译，分配，文档，团队协作和其他任务的无缝连接。 Maven增加可重用性并负责建立相关的任务。

### Maven的“约定优于配置”
所谓的"约定优于配置"，在maven中并不是完全不可以修改的，他们只是一些配置的默认值而已。但是使用者除非必要，并不需要去修改那些约定内容。maven默认的文件存放结构如下：</br>
~~~
/项目目录
pom.xml 用于maven的配置文件
/src 源代码目录
/src/main 工程源代码目录
/src/main/java 工程java源代码目录
/src/main/resource 工程的资源目录
/src/test 单元测试目录
/src/test/java
/target 输出目录，所有的输出物都存放在这个目录下
/target/classes 编译之后的class文件
~~~
每一个阶段的任务都知道怎么正确完成自己的工作，比如compile任务就知道从src/main/java下编译所有的java文件，并把它的输出class文件存放到target/classes中。</br>
对maven来说，采用"约定优于配置"的策略可以减少修改配置的工作量，也可以降低学习成本，更重要的是，给项目引入了统一的规范。

### Maven 版本规范
maven使用如下几个要素来唯一定位某一个输出物： groupId:artifactId:packaging:version 。比如 `org.springframework:spring:2.5` 。每个部分的解释如下：

* groupId </br>
    团体，公司，小组，组织，项目，或者其它团体。团体标识的约定是，它以创建这个项目的组织名称的逆向域名(reverse domain name)开头。来自Sonatype的项目有一个以com.sonatype开头的groupId，而Apache Software的项目有以org.apache开头的groupId。</br>
* artifactId </br>
    在groupId下的表示一个单独项目的唯一标识符。比如我们的tomcat, commons等。不要在artifactId中包含点号(.)。</br>
* version </br>
    一个项目的特定版本。发布的项目有一个固定的版本标识来指向该项目的某一个特定的版本。而正在开发中的项目可以用一个特殊的标识，这种标识给版本加上一个"SNAPSHOT"的标记。虽然项目的打包格式也是Maven坐标的重要组成部分，但是它不是项目唯一标识符的一个部分。一个项目的 groupId:artifactId:version使之成为一个独一无二的项目；你不能同时有一个拥有同样的groupId, artifactId和version标识的项目。</br>
* packaging </br>
    项目的类型，默认是jar，描述了项目打包后的输出。类型为jar的项目产生一个JAR文件，类型为war的项目产生一个web应用。</br>
* classifier </br>
    很少使用的坐标，一般都可以忽略classifiers。如果你要发布同样的代码，但是由于技术原因需要生成两个单独的构件，你就要使用一个分类器（classifier）。例如，如果你想要构建两个单独的构件成JAR，一个使用Java 1.4编译器，另一个使用Java 6编译器，你就可以使用分类器来生成两个单独的JAR构件，它们有同样的groupId:artifactId:version组合。如果你的项目使用本地扩展类库，你可以使用分类器为每一个目标平台生成一个构件。分类器常用于打包构件的源码，JavaDoc或者二进制集合。

maven有自己的版本规范，一般是如下定义 `<major version>.<minor version>.<incremental version>-<qualifier>` ，比如1.2.3-beta-01。要说明的是，maven自己判断版本的算法是major,minor,incremental部分用数字比较，qualifier部分用字符串比较，所以要小心 alpha-2和alpha-15的比较关系，最好用 alpha-02的格式。

maven在版本管理时候可以使用几个特殊的字符串**SNAPSHOT ,LATEST ,RELEASE** 。比如"1.0-SNAPSHOT"。各个部分的含义和处理逻辑如下说明：

* SNAPSHOT </br>
    如果一个版本包含字符串"SNAPSHOT"，Maven就会在安装或发布这个组件的时候将该符号展开为一个日期和时间值，转换为UTC时间。例如，"1.0-SNAPSHOT"会在2010年5月5日下午2点10分发布时候变成1.0-20100505-141000-1。
    这个词只能用于开发过程中，因为一般来说，项目组都会频繁发布一些版本，最后实际发布的时候，会在这些snapshot版本中寻找一个稳定的，用于正式发布，比如1.4版本发布之前，就会有一系列的1.4-SNAPSHOT，而实际发布的1.4，也是从中拿出来的一个稳定版。
* LATEST </br>
    指某个特定构件的最新发布，这个发布可能是一个发布版，也可能是一个snapshot版，具体看哪个时间最后。
* RELEASE </br>
    指最后一个发布版。

/*
Sort: 2
*/

#### 常用命令
* mvn archetype:generate  创建maven项目
* mvn package     打包，上面已经介绍过了
* mvn package -Prelease   打包，并生成部署用的包，比如deploy/*.tgz
* mvn install     打包并安装到本地库
* mvn eclipse:eclipse     生成eclipse项目文件
* mvn eclipse:clean   清除eclipse项目文件
* mvn site    生成项目相关信息的网站


#### mvn常用参数
* mvn -e    显示详细错误
* mvn -U    强制更新snapshot类型的插件或依赖库（否则maven一天只会更新一次snapshot依赖）
* mvn -o    运行offline模式，不联网更新依赖
* mvn -N    仅在当前项目模块执行命令，关闭reactor
* mvn -pl   module_name在指定模块上执行命令
* mvn -ff   在递归执行命令过程中，一旦发生错误就直接退出
* mvn -Dxxx=yyy 指定java全局属性
* mvn -Pxxx 引用profile xxx


#### Buile Lifecycle
* mvn test-compile   编译测试代码
* mvn test  运行程序中的单元测试
* mvn compile   编译项目
* mvn package   打包，此时target目录下会出现maven-quickstart-1.0-SNAPSHOT.jar文件，即为打包后文件
* mvn install   打包并安装到本地仓库，此时本机仓库会新增maven-quickstart-1.0-SNAPSHOT.jar文件。
每个phase都可以作为goal，也可以联合，如之前介绍的mvn clean install


#### maven插件常用参数
* mvn -Dwtpversion=2.0  指定maven版本
* mvn -Dmaven.test.skip=true    如果命令包含了test phase，则忽略单元测试
* mvn -DuserProp=filePath   指定用户自定义配置文件位置
* mvn -DdownloadSources=true -Declipse.addVersionToProjectName=true eclipse:eclipse     生成eclipse项目文件，尝试从仓库下载源代码，并且生成的项目包含模块版本（注意如果使用公用POM，上述的开关缺省已打开）
 
#### maven简单故障排除
* mvn -Dsurefire.useFile=false  如果执行单元测试出错，用该命令可以在console输出失败的单元测试及相关信息
* set MAVEN_OPTS=-Xmx512m -XX:MaxPermSize=256m  调大jvm内存和持久代，maven/jvm out of memory error
* mvn -X maven log level    设定为debug在运行
* mvndebug  运行jpda允许remote debug
* mvn –help     这个就不说了。。
